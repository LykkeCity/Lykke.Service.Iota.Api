{
	"info": {
		"_postman_id": "334442ed-a269-43aa-9de3-4f353daf40da",
		"name": "Iota - Main Flow",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Get asset info",
			"description": "",
			"item": [
				{
					"name": "/api/assets/{assetId} - get asset",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "51660cd4-127f-42c1-96b8-26b46fe56fac",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "63dc8492-4e9d-403e-8a51-c8e1e77caa40",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save asset info\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"assetAccuracy\", jsonData.accuracy);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/assets/{{asset-id}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"assets",
								"{{asset-id}}"
							]
						},
						"description": "activate params"
					},
					"response": []
				}
			]
		},
		{
			"name": "Add DW to balance observation",
			"description": "",
			"item": [
				{
					"name": "/api/balances/{address}/observation - delete DW address",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "d9dad08d-27dd-4345-a6d1-2d0f38d2c6a3",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "53a7fc19-bc79-4531-8653-c5fbf200b4a8",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or 204\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200,204]);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/balances/{{dw-address}}/observation",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances",
								"{{dw-address}}",
								"observation"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances/{address}/observation - add DW address",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "d9dad08d-27dd-4345-a6d1-2d0f38d2c6a3",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "5bee7399-cf86-41ed-87ff-3beef5956831",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/balances/{{dw-address}}/observation",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances",
								"{{dw-address}}",
								"observation"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances/{address}/observation - delete HW address",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "d9dad08d-27dd-4345-a6d1-2d0f38d2c6a3",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "53a7fc19-bc79-4531-8653-c5fbf200b4a8",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200 or 204\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200,204]);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/balances/{{hw-address}}/observation",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances",
								"{{hw-address}}",
								"observation"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances/{address}/observation - add HW address",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "d9dad08d-27dd-4345-a6d1-2d0f38d2c6a3",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "5bee7399-cf86-41ed-87ff-3beef5956831",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/balances/{{hw-address}}/observation",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances",
								"{{hw-address}}",
								"observation"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Send from DW to HW (5 IOTA)",
			"description": "",
			"item": [
				{
					"name": "/api/balances - get DW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "60a60c3a-0a52-4c0c-ae5a-026c05380f12",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var dwAddress = pm.environment.get(\"dw-address\")",
									"",
									"pm.test(\"Save DW balance\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === dwAddress) {",
									"            console.info(\"Balance: \" + item.balance);",
									"            console.info(\"Block: \" + item.block);",
									"            ",
									"            pm.environment.set(\"dwBalance\", item.balance);",
									"        }",
									"    }",
									"});"
								]
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "a667f322-526c-4370-94aa-f5439f1e693f",
								"type": "text/javascript",
								"exec": [
									"console.info(\"Wait 70 secs\");",
									"setTimeout(function(){}, 70000);"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "a5d9a9b3-248b-43ed-af59-b2196b5fa94f",
								"type": "text/javascript",
								"exec": [
									"function S4() {",
									"    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);",
									"}",
									"",
									"function guid() {",
									"    return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());",
									"}",
									"",
									"var newGuid = guid();",
									"",
									"console.info(\"operationId=\" + newGuid);",
									"",
									"var dwBalance = pm.environment.get(\"dwBalance\")",
									"",
									"pm.environment.set(\"operationId\", newGuid);",
									"pm.environment.set(\"amount-1st-dw-hw\", 5);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "2b7c837c-c126-47c6-9529-3feb153c85ee",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"transactionContext\", jsonData.transactionContext);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{dw-address}}\",\r\n  \"toAddress\": \"{{hw-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount-1st-dw-hw}},\r\n  \"includeFee\": true\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction again",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "b0a8c2b0-8534-4a89-a404-92494192378f",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "e952d7d3-1d98-42c5-abef-16f075adb72a",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    var expected = pm.environment.get(\"transactionContext\");",
									"    var current = jsonData.transactionContext;",
									"    ",
									"    console.info(\"expected: \" + expected);",
									"    console.info(\"current: \" + current);",
									"    ",
									"    pm.expect(expected).to.eql(current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{dw-address}}\",\r\n  \"toAddress\": \"{{hw-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount-1st-dw-hw}},\r\n  \"includeFee\": false\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/sign - sign transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c1584453-a043-4123-89d3-3c97c60fe90f",
								"type": "text/javascript",
								"exec": [
									"",
									"",
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "de09d592-7c10-4ae0-a142-002dbc75e203",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save signedTransaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    console.info(\"signedTransaction: \" + jsonData.signedTransaction);",
									"    ",
									"    pm.environment.set(\"signedTransaction\", jsonData.signedTransaction);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"privateKeys\": [\r\n    \"{{dw-private-key}}\"\r\n  ],\r\n  \"transactionContext\": '{{transactionContext}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-sign}}/api/sign",
							"host": [
								"{{domain-sign}}"
							],
							"path": [
								"api",
								"sign"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast - broadcast transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "a883f8ba-96b5-4d7d-adc1-f72d514c0a14",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "eaee924c-f664-4390-8602-2eb7b60cc89e",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"signedTransaction\": '{{signedTransaction}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/single/{operationId} - wait transaction completion (20 IOTA)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "0ed28a45-17af-49ab-b37b-cd52275f6e68",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = jsonData.state;",
									"var expected = \"completed\";",
									"",
									"if(current == expected){",
									"    console.info(\"Transaction completed in block=\" + jsonData.block);",
									"} else {",
									"    console.info(\"current state:\" + current);",
									"    console.info(\"Wait 60 secs\");",
									"    setTimeout(function(){}, 60000);",
									"    postman.setNextRequest(\"/api/transactions/broadcast/single/{operationId} - wait transaction completion (20 IOTA)\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/single/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"single",
								"{{operationId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - check DW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "0df8b593-c481-4b2e-8819-44c8832091c1",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check DW balance\", function() {",
									"    var jsonData = pm.response.json();",
									"",
									"    var dwAddress = pm.environment.get(\"dw-address\")",
									"    var dwBalanceCurrent = 0;",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === dwAddress) {",
									"            dwBalanceCurrent = Number(item.balance);",
									"        }",
									"    }",
									"    ",
									"    var dwBalanceBefore = pm.environment.get(\"dwBalance\");",
									"    var amount1stDwHw = pm.environment.get(\"amount-1st-dw-hw\");",
									"    var dwBalanceExpected = Number(dwBalanceBefore) - Number(amount1stDwHw);",
									"    ",
									"    console.info(\"amount1stDwHw: \" + amount1stDwHw);",
									"    console.info(\"dwBalanceBefore: \" + dwBalanceBefore);    ",
									"    console.info(\"dwBalanceCurrent: \" + dwBalanceCurrent);",
									"    console.info(\"dwBalanceExpected: \" + dwBalanceExpected);",
									"",
									"    pm.expect(dwBalanceExpected).to.eql(dwBalanceCurrent);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/{operationId} - delete operation",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "415ed145-c923-4424-8fcd-e5e6971a0f2c",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"{{operationId}}"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "85de6852-effc-40aa-9f22-5e34ffe777b9",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "2ab82db8-14ed-4a1c-bb4d-91f5e66ecce4",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Send from DW to HW (Rest amount)",
			"description": "",
			"item": [
				{
					"name": "/api/balances - get DW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "60a60c3a-0a52-4c0c-ae5a-026c05380f12",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var dwAddress = pm.environment.get(\"dw-address\")",
									"",
									"pm.test(\"Save DW balance\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === dwAddress) {",
									"            console.info(\"Balance: \" + item.balance);",
									"            console.info(\"Block: \" + item.block);",
									"            ",
									"            pm.environment.set(\"dwBalance\", item.balance);",
									"        }",
									"    }",
									"});"
								]
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "9392336e-3323-4e3e-a915-ff870dc0c00f",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "5834a382-d50a-42c9-8492-5a936265936c",
								"type": "text/javascript",
								"exec": [
									"function S4() {",
									"    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);",
									"}",
									"",
									"function guid() {",
									"    return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());",
									"}",
									"",
									"var newGuid = guid();",
									"",
									"console.info(\"operationId=\" + newGuid);",
									"",
									"var dwBalance = pm.environment.get(\"dwBalance\")",
									"",
									"pm.environment.set(\"operationId\", newGuid);",
									"pm.environment.set(\"amount\", dwBalance);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "2b7c837c-c126-47c6-9529-3feb153c85ee",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"transactionContext\", jsonData.transactionContext);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{dw-address}}\",\r\n  \"toAddress\": \"{{hw-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount}},\r\n  \"includeFee\": true\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction again",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "b0a8c2b0-8534-4a89-a404-92494192378f",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "e952d7d3-1d98-42c5-abef-16f075adb72a",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    var expected = pm.environment.get(\"transactionContext\");",
									"    var current = jsonData.transactionContext;",
									"    ",
									"    console.info(\"expected: \" + expected);",
									"    console.info(\"current: \" + current);",
									"    ",
									"    pm.expect(expected).to.eql(current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{dw-address}}\",\r\n  \"toAddress\": \"{{hw-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount}},\r\n  \"includeFee\": false\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/sign - sign transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c1584453-a043-4123-89d3-3c97c60fe90f",
								"type": "text/javascript",
								"exec": [
									"",
									"",
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "de09d592-7c10-4ae0-a142-002dbc75e203",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save signedTransaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    console.info(\"signedTransaction: \" + jsonData.signedTransaction);",
									"    ",
									"    pm.environment.set(\"signedTransaction\", jsonData.signedTransaction);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"privateKeys\": [\r\n    \"{{dw-private-key}}\"\r\n  ],\r\n  \"transactionContext\": '{{transactionContext}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-sign}}/api/sign",
							"host": [
								"{{domain-sign}}"
							],
							"path": [
								"api",
								"sign"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast - broadcast transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "a883f8ba-96b5-4d7d-adc1-f72d514c0a14",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "eaee924c-f664-4390-8602-2eb7b60cc89e",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"signedTransaction\": '{{signedTransaction}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/single/{operationId} - wait transaction completion (rest)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "c9d3a084-036c-4775-8ae9-f79b3bd52b2d",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = jsonData.state;",
									"var expected = \"completed\";",
									"",
									"if(current == expected){",
									"    console.info(\"Transaction completed in block=\" + jsonData.block);",
									"} else {",
									"    console.info(\"current state:\" + current);",
									"    console.info(\"Wait 60 secs\");",
									"    setTimeout(function(){}, 60000);",
									"    postman.setNextRequest(\"/api/transactions/broadcast/single/{operationId} - wait transaction completion (rest)\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/single/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"single",
								"{{operationId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - check DW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "9f16cf36-3525-44f4-aef6-7e0dbe9cbda3",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check DW balance\", function() {",
									"    var jsonData = pm.response.json();",
									"",
									"    var dwAddress = pm.environment.get(\"dw-address\")",
									"    var dwBalanceCurrent = 0;",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === dwAddress) {",
									"            dwBalanceCurrent = Number(item.balance);",
									"        }",
									"    }",
									"    ",
									"    var dwBalanceBefore = pm.environment.get(\"dwBalance\");",
									"    var amount = pm.environment.get(\"amount\");",
									"    var dwBalanceExpected = Number(dwBalanceBefore) - Number(amount);",
									"    ",
									"    console.info(\"amount: \" + amount);",
									"    console.info(\"dwBalanceBefore: \" + dwBalanceBefore);    ",
									"    console.info(\"dwBalanceCurrent: \" + dwBalanceCurrent);",
									"    console.info(\"dwBalanceExpected: \" + dwBalanceExpected);",
									"",
									"    pm.expect(dwBalanceExpected).to.eql(dwBalanceCurrent);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/{operationId} - delete operation",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "415ed145-c923-4424-8fcd-e5e6971a0f2c",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"{{operationId}}"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "6425ceb1-95fa-48ad-b897-f08056618e95",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "f6e8992b-5c66-4d20-a122-481c7de84576",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Send from HW to DW (10 IOTA)",
			"description": "",
			"item": [
				{
					"name": "/api/balances - get HW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "de3a5b02-07c3-46e3-8bd7-0dd560b754e8",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var hwAddress = pm.environment.get(\"hw-address\")",
									"",
									"pm.test(\"Save HW balance\", function () {",
									"    var jsonData = pm.response.json();",
									"    var hwBalance = 0;",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === hwAddress) {",
									"            hwBalance = item.balance;",
									"        }",
									"    }",
									"    ",
									"    console.info(\"hwBalance: \" + hwBalance);",
									"",
									"    pm.environment.set(\"hwBalance\", hwBalance);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - get DW real address",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "166f7757-a39c-4d38-9795-ef11ce71b3d2",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var hwAddress = pm.environment.get(\"hw-address\")",
									"",
									"pm.test(\"Save DW real address\", function () {",
									"    var dwRealAddress = pm.response.text();",
									"    ",
									"    console.info(\"dw-real-address: \" + dwRealAddress);",
									"",
									"    pm.environment.set(\"dw-real-address\", dwRealAddress);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/internal/virtual-address/{{dw-address}}/real",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"internal",
								"virtual-address",
								"{{dw-address}}",
								"real"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "1ec3aa7a-d92e-4d37-93dd-ea2692f601e7",
								"type": "text/javascript",
								"exec": [
									"function S4() {",
									"    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);",
									"}",
									"",
									"function guid() {",
									"    return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());",
									"}",
									"",
									"var newGuid = guid();",
									"",
									"console.info(\"operationId=\" + newGuid);",
									"",
									"var hwBalance = pm.environment.get(\"hwBalance\")",
									"",
									"pm.environment.set(\"operationId\", newGuid);",
									"pm.environment.set(\"amount\", hwBalance);",
									"pm.environment.set(\"amount-1st-hw-dw\", 10);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "2b7c837c-c126-47c6-9529-3feb153c85ee",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"transactionContext\", jsonData.transactionContext);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{hw-address}}\",\r\n  \"toAddress\": \"{{dw-real-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount-1st-hw-dw}},\r\n  \"includeFee\": false\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/sign - sign transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c1584453-a043-4123-89d3-3c97c60fe90f",
								"type": "text/javascript",
								"exec": [
									"",
									"",
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "29d4c79a-1d69-46eb-be6e-968b558fc8a2",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save signedTransaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    console.info(\"signedTransaction: \" + jsonData.signedTransaction);",
									"    ",
									"    pm.environment.set(\"signedTransaction\", jsonData.signedTransaction);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"privateKeys\": [\r\n    \"{{hw-private-key}}\"\r\n  ],\r\n  \"transactionContext\": '{{transactionContext}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-sign}}/api/sign",
							"host": [
								"{{domain-sign}}"
							],
							"path": [
								"api",
								"sign"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast - broadcast transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "9dce0571-e646-46c1-9f6f-f80db944082a",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "eaee924c-f664-4390-8602-2eb7b60cc89e",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"signedTransaction\": '{{signedTransaction}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/single/{operationId} - wait hw transaction completion (10 IOTA)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "ae72fd4c-a949-4cff-8305-aa1d2e2469dc",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = jsonData.state;",
									"var expected = \"completed\";",
									"",
									"if(current == expected){",
									"    console.info(\"Transaction completed in block=\" + jsonData.block);",
									"    ",
									"    pm.test(\"Check amount\", function () {",
									"        var amount = Number(pm.environment.get(\"amount\"));",
									"        var amount_1st_hw_dw = Number(pm.environment.get(\"amount-1st-hw-dw\"));",
									"        var txAmount = Number(jsonData.amount);",
									"    ",
									"        pm.expect(txAmount).to.eql(amount_1st_hw_dw);",
									"    });",
									"} else {",
									"    console.info(\"current state:\" + current);",
									"    console.info(\"Wait 60 secs\");",
									"    setTimeout(function(){}, 60000);",
									"    postman.setNextRequest(\"/api/transactions/broadcast/single/{operationId} - wait hw transaction completion (10 IOTA)\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/single/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"single",
								"{{operationId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - check DW/HW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "c6460279-24ad-4bca-8469-e5b48200c2bb",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check DW balance\", function() {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    console.info(\"jsonData: \" + jsonData);",
									"",
									"    var dwAddress = pm.environment.get(\"dw-address\")",
									"    var dwBalanceCurrent = 0;",
									"",
									"    var hwAddress = pm.environment.get(\"hw-address\")",
									"    var hwBalanceCurrent = 0;",
									"",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === dwAddress) {",
									"            dwBalanceCurrent = Number(item.balance);",
									"        }",
									"        if(item.address === hwAddress) {",
									"            hwBalanceCurrent = Number(item.balance);",
									"        }        ",
									"    }",
									"    ",
									"    var dwBalanceBefore = 0;",
									"    var hwBalanceBefore = Number(pm.environment.get(\"hwBalance\"));",
									"    var amount_1st_hw_dw = Number(pm.environment.get(\"amount-1st-hw-dw\"));",
									"    var dwBalanceExpected = amount_1st_hw_dw;",
									"    var hwBalanceExpected = hwBalanceBefore - amount_1st_hw_dw;",
									"    ",
									"    console.info(\"amount_1st_hw_dw: \" + amount_1st_hw_dw);",
									"    console.info(\"dwBalanceBefore: \" + dwBalanceBefore);",
									"    console.info(\"dwBalanceCurrent: \" + dwBalanceCurrent);",
									"    console.info(\"dwBalanceExpected: \" + dwBalanceExpected);",
									"    ",
									"    console.info(\"hwBalanceBefore: \" + hwBalanceBefore);",
									"    console.info(\"hwBalanceCurrent: \" + hwBalanceCurrent);",
									"    console.info(\"hwBalanceExpected: \" + hwBalanceExpected);",
									"",
									"    pm.expect(dwBalanceExpected).to.eql(dwBalanceCurrent);",
									"    pm.expect(hwBalanceExpected).to.eql(hwBalanceCurrent);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/{operationId} - delete operation",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "415ed145-c923-4424-8fcd-e5e6971a0f2c",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"{{operationId}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Send from HW to DW (Rest amount)",
			"description": "",
			"item": [
				{
					"name": "/api/balances - get HW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "de3a5b02-07c3-46e3-8bd7-0dd560b754e8",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var hwAddress = pm.environment.get(\"hw-address\")",
									"",
									"pm.test(\"Save HW balance\", function () {",
									"    var jsonData = pm.response.json();",
									"    var hwBalance = 0;",
									"    ",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === hwAddress) {",
									"            hwBalance = item.balance;",
									"        }",
									"    }",
									"    ",
									"    console.info(\"hwBalance: \" + hwBalance);",
									"",
									"    pm.environment.set(\"hwBalance\", hwBalance);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - get DW real address",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "166f7757-a39c-4d38-9795-ef11ce71b3d2",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var hwAddress = pm.environment.get(\"hw-address\")",
									"",
									"pm.test(\"Save DW real address\", function () {",
									"    var dwRealAddress = pm.response.text();",
									"    ",
									"    console.info(\"dw-real-address: \" + dwRealAddress);",
									"",
									"    pm.environment.set(\"dw-real-address\", dwRealAddress);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/internal/virtual-address/{{dw-address}}/real",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"internal",
								"virtual-address",
								"{{dw-address}}",
								"real"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/single - build transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "935494e6-2e69-49aa-9644-7b96203ea05f",
								"type": "text/javascript",
								"exec": [
									"function S4() {",
									"    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);",
									"}",
									"",
									"function guid() {",
									"    return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());",
									"}",
									"",
									"var newGuid = guid();",
									"",
									"console.info(\"operationId=\" + newGuid);",
									"",
									"var hwBalance = pm.environment.get(\"hwBalance\")",
									"",
									"pm.environment.set(\"operationId\", newGuid);",
									"pm.environment.set(\"amount\", hwBalance);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "2b7c837c-c126-47c6-9529-3feb153c85ee",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save transactionContext\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"transactionContext\", jsonData.transactionContext);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"fromAddress\": \"{{hw-address}}\",\r\n  \"toAddress\": \"{{dw-real-address}}\",\r\n  \"assetId\": \"{{asset-id}}\",\r\n  \"amount\": {{amount}},\r\n  \"includeFee\": false\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/single",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"single"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/sign - sign transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c1584453-a043-4123-89d3-3c97c60fe90f",
								"type": "text/javascript",
								"exec": [
									"",
									"",
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "29d4c79a-1d69-46eb-be6e-968b558fc8a2",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save signedTransaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    console.info(\"signedTransaction: \" + jsonData.signedTransaction);",
									"    ",
									"    pm.environment.set(\"signedTransaction\", jsonData.signedTransaction);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"privateKeys\": [\r\n    \"{{hw-private-key}}\"\r\n  ],\r\n  \"transactionContext\": '{{transactionContext}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-sign}}/api/sign",
							"host": [
								"{{domain-sign}}"
							],
							"path": [
								"api",
								"sign"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast - broadcast transaction",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "9dce0571-e646-46c1-9f6f-f80db944082a",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "eaee924c-f664-4390-8602-2eb7b60cc89e",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"operationId\": \"{{operationId}}\",\r\n  \"signedTransaction\": '{{signedTransaction}}'\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/single/{operationId} - wait hw transaction completion (rest)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "22a34ab0-2684-42d2-bdbb-94cafb2de44a",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = jsonData.state;",
									"var expected = \"completed\";",
									"",
									"if(current == expected){",
									"    console.info(\"Transaction completed in block=\" + jsonData.block);",
									"    ",
									"    pm.test(\"Check amount\", function () {",
									"        var amount = Number(pm.environment.get(\"amount\"));",
									"        var txAmount = Number(jsonData.amount);",
									"    ",
									"        pm.expect(txAmount).to.eql(amount);",
									"    });",
									"} else {",
									"    console.info(\"current state:\" + current);",
									"    console.info(\"Wait 60 secs\");",
									"    setTimeout(function(){}, 60000);",
									"    postman.setNextRequest(\"/api/transactions/broadcast/single/{operationId} - wait hw transaction completion (rest)\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/single/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"single",
								"{{operationId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/balances - check HW balance",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "29377604-53f2-4786-8009-f9b2053f67a0",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Check DW balance\", function() {",
									"    var jsonData = pm.response.json();",
									"",
									"    var hwAddress = pm.environment.get(\"hw-address\")",
									"    var hwBalanceCurrent = 0;",
									"",
									"    for (var item of jsonData.items) { ",
									"        if(item.address === hwAddress) {",
									"            hwBalanceCurrent = Number(item.balance);",
									"        }",
									"    }",
									"    ",
									"    var hwBalanceBefore = pm.environment.get(\"hwBalance\");",
									"    var amount = pm.environment.get(\"amount\");",
									"    var hwBalanceExpected = Number(hwBalanceBefore) - Number(amount);",
									"    ",
									"    console.info(\"amount: \" + amount);",
									"    console.info(\"hwBalanceBefore: \" + hwBalanceBefore);    ",
									"    console.info(\"hwBalanceCurrent: \" + hwBalanceCurrent);",
									"    console.info(\"hwBalanceExpected: \" + hwBalanceExpected);",
									"",
									"    pm.expect(hwBalanceExpected).to.eql(hwBalanceCurrent);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain-api}}/api/balances?take=500",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"balances"
							],
							"query": [
								{
									"key": "take",
									"value": "500"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "/api/transactions/broadcast/{operationId} - delete operation",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "415ed145-c923-4424-8fcd-e5e6971a0f2c",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain-api}}/api/transactions/broadcast/{{operationId}}",
							"host": [
								"{{domain-api}}"
							],
							"path": [
								"api",
								"transactions",
								"broadcast",
								"{{operationId}}"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "4a0d9bab-a4f6-4652-91a0-44832cfaeb8c",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "6f28d2e6-0659-45db-a6e9-791ab0340081",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "4651c875-ac4f-4574-ae42-bf567a80984a",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "a585c4a6-7447-4664-b68f-d4e567e7476d",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	]
}